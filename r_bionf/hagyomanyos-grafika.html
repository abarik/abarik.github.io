<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.1 Hagyományos grafika | R alapok I. - RNS szekvenálási példákkal</title>
  <meta name="description" content="Adatmanipuláció, egyváltozós elemzések és megismételhető kutatás bioinformatikai példákkal." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="7.1 Hagyományos grafika | R alapok I. - RNS szekvenálási példákkal" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="Adatmanipuláció, egyváltozós elemzések és megismételhető kutatás bioinformatikai példákkal." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.1 Hagyományos grafika | R alapok I. - RNS szekvenálási példákkal" />
  
  <meta name="twitter:description" content="Adatmanipuláció, egyváltozós elemzések és megismételhető kutatás bioinformatikai példákkal." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Abari Kálmán" />


<meta name="date" content="2019-09-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="grafika-az-r-ben.html">
<link rel="next" href="a-modern-grafika-ggplot2.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R alapok I. - RNS szekvenálási példákkal</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Bevezetés</a><ul>
<li class="chapter" data-level="1.1" data-path="az-r.html"><a href="az-r.html"><i class="fa fa-check"></i><b>1.1</b> Az R</a></li>
<li class="chapter" data-level="1.2" data-path="alapelvek-az-r-hasznalatahoz.html"><a href="alapelvek-az-r-hasznalatahoz.html"><i class="fa fa-check"></i><b>1.2</b> Alapelvek az R használatához</a></li>
<li class="chapter" data-level="1.3" data-path="Ralaptudas.html"><a href="Ralaptudas.html"><i class="fa fa-check"></i><b>1.3</b> Az R alaptudás</a></li>
<li class="chapter" data-level="1.4" data-path="a-modern-r.html"><a href="a-modern-r.html"><i class="fa fa-check"></i><b>1.4</b> A modern R</a></li>
<li class="chapter" data-level="1.5" data-path="jelolesi-konvenciok.html"><a href="jelolesi-konvenciok.html"><i class="fa fa-check"></i><b>1.5</b> Jelölési konvenciók</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="alapok.html"><a href="alapok.html"><i class="fa fa-check"></i><b>2</b> Alapok</a><ul>
<li class="chapter" data-level="2.1" data-path="szereplok-es-fogalmak.html"><a href="szereplok-es-fogalmak.html"><i class="fa fa-check"></i><b>2.1</b> Szereplők és fogalmak</a></li>
<li class="chapter" data-level="2.2" data-path="telepitesek.html"><a href="telepitesek.html"><i class="fa fa-check"></i><b>2.2</b> Telepítések</a><ul>
<li class="chapter" data-level="2.2.1" data-path="telepitesek.html"><a href="telepitesek.html#az-alap-r-telepitese"><i class="fa fa-check"></i><b>2.2.1</b> Az Alap R telepítése</a></li>
<li class="chapter" data-level="2.2.2" data-path="telepitesek.html"><a href="telepitesek.html#az-rstudio-telepitese"><i class="fa fa-check"></i><b>2.2.2</b> Az RStudio telepítése</a></li>
<li class="chapter" data-level="2.2.3" data-path="telepitesek.html"><a href="telepitesek.html#Csomagok_telepitese"><i class="fa fa-check"></i><b>2.2.3</b> Csomagok telepítése</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="az-elso-lepesek.html"><a href="az-elso-lepesek.html"><i class="fa fa-check"></i><b>2.3</b> Az első lépések</a><ul>
<li class="chapter" data-level="2.3.1" data-path="az-elso-lepesek.html"><a href="az-elso-lepesek.html#a-konzol-hasznalata"><i class="fa fa-check"></i><b>2.3.1</b> A konzol használata</a></li>
<li class="chapter" data-level="2.3.2" data-path="az-elso-lepesek.html"><a href="az-elso-lepesek.html#parancsallomanyok"><i class="fa fa-check"></i><b>2.3.2</b> Parancsállományok</a></li>
<li class="chapter" data-level="2.3.3" data-path="az-elso-lepesek.html"><a href="az-elso-lepesek.html#parancsallomanyok-futtatasa"><i class="fa fa-check"></i><b>2.3.3</b> Parancsállományok futtatása</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="az-rstudio.html"><a href="az-rstudio.html"><i class="fa fa-check"></i><b>2.4</b> Az RStudio</a><ul>
<li class="chapter" data-level="2.4.1" data-path="az-rstudio.html"><a href="az-rstudio.html#panelek"><i class="fa fa-check"></i><b>2.4.1</b> Panelek</a></li>
<li class="chapter" data-level="2.4.2" data-path="az-rstudio.html"><a href="az-rstudio.html#munka-az-rstudio-ban"><i class="fa fa-check"></i><b>2.4.2</b> Munka az RStudio-ban</a></li>
<li class="chapter" data-level="2.4.3" data-path="az-rstudio.html"><a href="az-rstudio.html#projektek-hasznalata"><i class="fa fa-check"></i><b>2.4.3</b> Projektek használata</a></li>
<li class="chapter" data-level="2.4.4" data-path="az-rstudio.html"><a href="az-rstudio.html#az-rmarkdown-hasznalata"><i class="fa fa-check"></i><b>2.4.4</b> Az RMarkdown használata</a></li>
<li class="chapter" data-level="2.4.5" data-path="az-rstudio.html"><a href="az-rstudio.html#billenytuparancsok"><i class="fa fa-check"></i><b>2.4.5</b> Billenytűparancsok</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="segitseg-az-r-hasznalatahoz.html"><a href="segitseg-az-r-hasznalatahoz.html"><i class="fa fa-check"></i><b>2.5</b> Segítség az R használatához</a></li>
<li class="chapter" data-level="2.6" data-path="feladatok.html"><a href="feladatok.html"><i class="fa fa-check"></i><b>2.6</b> Feladatok</a></li>
</ul></li>
<li class="part"><span><b>I Az R nyelv</b></span></li>
<li class="chapter" data-level="3" data-path="adatobjektumok.html"><a href="adatobjektumok.html"><i class="fa fa-check"></i><b>3</b> Adatobjektumok</a><ul>
<li class="chapter" data-level="3.1" data-path="szamolas-az-r-ben.html"><a href="szamolas-az-r-ben.html"><i class="fa fa-check"></i><b>3.1</b> Számolás az R-ben</a></li>
<li class="chapter" data-level="3.2" data-path="objektumok.html"><a href="objektumok.html"><i class="fa fa-check"></i><b>3.2</b> Objektumok</a><ul>
<li class="chapter" data-level="3.2.1" data-path="objektumok.html"><a href="objektumok.html#objektumok-letrehozasa"><i class="fa fa-check"></i><b>3.2.1</b> Objektumok létrehozása</a></li>
<li class="chapter" data-level="3.2.2" data-path="objektumok.html"><a href="objektumok.html#objektumok-ertekenek-lekerdezese"><i class="fa fa-check"></i><b>3.2.2</b> Objektumok értékének lekérdezése</a></li>
<li class="chapter" data-level="3.2.3" data-path="objektumok.html"><a href="objektumok.html#objektumok-elnevezese"><i class="fa fa-check"></i><b>3.2.3</b> Objektumok elnevezése</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="feladatok-1.html"><a href="feladatok-1.html"><i class="fa fa-check"></i><b>3.3</b> Feladatok</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fuggvenyek.html"><a href="fuggvenyek.html"><i class="fa fa-check"></i><b>4</b> Függvények</a><ul>
<li class="chapter" data-level="4.1" data-path="a-fuggvenyhivas-szabalyai.html"><a href="a-fuggvenyhivas-szabalyai.html"><i class="fa fa-check"></i><b>4.1</b> A függvényhívás szabályai</a></li>
<li class="chapter" data-level="4.2" data-path="a-munkaterulet-fuggvenyei.html"><a href="a-munkaterulet-fuggvenyei.html"><i class="fa fa-check"></i><b>4.2</b> A munkaterület függvényei</a></li>
<li class="chapter" data-level="4.3" data-path="a-munkakonyvtar-fuggvenyei.html"><a href="a-munkakonyvtar-fuggvenyei.html"><i class="fa fa-check"></i><b>4.3</b> A munkakönyvtár függvényei</a></li>
<li class="chapter" data-level="4.4" data-path="csomagkezelo-fuggvenyek.html"><a href="csomagkezelo-fuggvenyek.html"><i class="fa fa-check"></i><b>4.4</b> Csomagkezelő függvények</a></li>
<li class="chapter" data-level="4.5" data-path="feladatok-2.html"><a href="feladatok-2.html"><i class="fa fa-check"></i><b>4.5</b> Feladatok</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="adatszerkezetek.html"><a href="adatszerkezetek.html"><i class="fa fa-check"></i><b>5</b> Adatszerkezetek</a><ul>
<li class="chapter" data-level="5.1" data-path="alaptipusok.html"><a href="alaptipusok.html"><i class="fa fa-check"></i><b>5.1</b> Alaptípusok</a><ul>
<li class="chapter" data-level="5.1.1" data-path="alaptipusok.html"><a href="alaptipusok.html#numerikus-ertekek"><i class="fa fa-check"></i><b>5.1.1</b> Numerikus értékek</a></li>
<li class="chapter" data-level="5.1.2" data-path="alaptipusok.html"><a href="alaptipusok.html#karakteres-ertekek"><i class="fa fa-check"></i><b>5.1.2</b> Karakteres értékek</a></li>
<li class="chapter" data-level="5.1.3" data-path="alaptipusok.html"><a href="alaptipusok.html#logikai-ertekek"><i class="fa fa-check"></i><b>5.1.3</b> Logikai értékek</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="adatszerkezetek-attekintese.html"><a href="adatszerkezetek-attekintese.html"><i class="fa fa-check"></i><b>5.2</b> Adatszerkezetek áttekintése</a></li>
<li class="chapter" data-level="5.3" data-path="vektor.html"><a href="vektor.html"><i class="fa fa-check"></i><b>5.3</b> Vektor</a><ul>
<li class="chapter" data-level="5.3.1" data-path="vektor.html"><a href="vektor.html#vektorok-letrehozasa"><i class="fa fa-check"></i><b>5.3.1</b> Vektorok létrehozása</a></li>
<li class="chapter" data-level="5.3.2" data-path="vektor.html"><a href="vektor.html#muveletek-vektorokkal"><i class="fa fa-check"></i><b>5.3.2</b> Műveletek vektorokkal</a></li>
<li class="chapter" data-level="5.3.3" data-path="vektor.html"><a href="vektor.html#fuggvenyek-vektorokkal"><i class="fa fa-check"></i><b>5.3.3</b> Függvények vektorokkal</a></li>
<li class="chapter" data-level="5.3.4" data-path="vektor.html"><a href="vektor.html#az-na-hianyzo-ertek"><i class="fa fa-check"></i><b>5.3.4</b> Az <code>NA</code> hiányzó érték</a></li>
<li class="chapter" data-level="5.3.5" data-path="vektor.html"><a href="vektor.html#objektumok-attributumai"><i class="fa fa-check"></i><b>5.3.5</b> Objektumok attribútumai</a></li>
<li class="chapter" data-level="5.3.6" data-path="vektor.html"><a href="vektor.html#vektorok-indexelese"><i class="fa fa-check"></i><b>5.3.6</b> Vektorok indexelése</a></li>
<li class="chapter" data-level="5.3.7" data-path="vektor.html"><a href="vektor.html#vektorok-rendezese"><i class="fa fa-check"></i><b>5.3.7</b> Vektorok rendezése</a></li>
<li class="chapter" data-level="5.3.8" data-path="vektor.html"><a href="vektor.html#elore-definialt-objektumok-nevesitett-konstansok"><i class="fa fa-check"></i><b>5.3.8</b> Előre definiált objektumok, nevesített konstansok</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="faktorok.html"><a href="faktorok.html"><i class="fa fa-check"></i><b>5.4</b> Faktorok</a></li>
<li class="chapter" data-level="5.5" data-path="matrixok-es-tombok.html"><a href="matrixok-es-tombok.html"><i class="fa fa-check"></i><b>5.5</b> Mátrixok és tömbök</a><ul>
<li class="chapter" data-level="5.5.1" data-path="matrixok-es-tombok.html"><a href="matrixok-es-tombok.html#szamitasok-a-matrix-soraiban-es-oszlopaiban"><i class="fa fa-check"></i><b>5.5.1</b> Számítások a mátrix soraiban és oszlopaiban</a></li>
<li class="chapter" data-level="5.5.2" data-path="matrixok-es-tombok.html"><a href="matrixok-es-tombok.html#sorok-es-oszlopok-kezelese"><i class="fa fa-check"></i><b>5.5.2</b> Sorok és oszlopok kezelése</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="listak.html"><a href="listak.html"><i class="fa fa-check"></i><b>5.6</b> Listák</a></li>
<li class="chapter" data-level="5.7" data-path="adattablak-dataframes.html"><a href="adattablak-dataframes.html"><i class="fa fa-check"></i><b>5.7</b> Adattáblák (dataframes)</a></li>
<li class="chapter" data-level="5.8" data-path="feladatok-3.html"><a href="feladatok-3.html"><i class="fa fa-check"></i><b>5.8</b> Feladatok</a></li>
</ul></li>
<li class="part"><span><b>II Adatelemzés</b></span></li>
<li class="chapter" data-level="6" data-path="adatok-beolvasasa-es-kiirasa.html"><a href="adatok-beolvasasa-es-kiirasa.html"><i class="fa fa-check"></i><b>6</b> Adatok beolvasása és kiírása</a><ul>
<li class="chapter" data-level="6.1" data-path="adatok-beolvasasa.html"><a href="adatok-beolvasasa.html"><i class="fa fa-check"></i><b>6.1</b> Adatok beolvasása</a><ul>
<li class="chapter" data-level="6.1.1" data-path="adatok-beolvasasa.html"><a href="adatok-beolvasasa.html#inline-beolvasas"><i class="fa fa-check"></i><b>6.1.1</b> Inline beolvasás</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tagolt-szoveges-allomanyok-beolvasasa.html"><a href="tagolt-szoveges-allomanyok-beolvasasa.html"><i class="fa fa-check"></i><b>6.2</b> Tagolt szöveges állományok beolvasása</a><ul>
<li class="chapter" data-level="6.2.1" data-path="tagolt-szoveges-allomanyok-beolvasasa.html"><a href="tagolt-szoveges-allomanyok-beolvasasa.html#a-read.table-csalad-ar"><i class="fa fa-check"></i><b>6.2.1</b> A <code>read.table()</code> család (AR)</a></li>
<li class="chapter" data-level="6.2.2" data-path="tagolt-szoveges-allomanyok-beolvasasa.html"><a href="tagolt-szoveges-allomanyok-beolvasasa.html#a-read_delim-fuggvenycsalad-tr"><i class="fa fa-check"></i><b>6.2.2</b> A <code>read_delim()</code> függvénycsalád (TR)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="fix-szeles-allomanyok.html"><a href="fix-szeles-allomanyok.html"><i class="fa fa-check"></i><b>6.3</b> Fix széles állományok</a></li>
<li class="chapter" data-level="6.4" data-path="univerzalis-megoldas.html"><a href="univerzalis-megoldas.html"><i class="fa fa-check"></i><b>6.4</b> Univerzális megoldás</a></li>
<li class="chapter" data-level="6.5" data-path="r-objektomok-irasa-es-olvasasa.html"><a href="r-objektomok-irasa-es-olvasasa.html"><i class="fa fa-check"></i><b>6.5</b> R objektomok írása és olvasása</a></li>
<li class="chapter" data-level="6.6" data-path="a-rio-csomag.html"><a href="a-rio-csomag.html"><i class="fa fa-check"></i><b>6.6</b> A <strong>rio</strong> csomag</a></li>
<li class="chapter" data-level="6.7" data-path="adatok-kiirasa.html"><a href="adatok-kiirasa.html"><i class="fa fa-check"></i><b>6.7</b> Adatok kiírása</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="grafika-az-r-ben.html"><a href="grafika-az-r-ben.html"><i class="fa fa-check"></i><b>7</b> Grafika az R-ben</a><ul>
<li class="chapter" data-level="7.1" data-path="hagyomanyos-grafika.html"><a href="hagyomanyos-grafika.html"><i class="fa fa-check"></i><b>7.1</b> Hagyományos grafika</a><ul>
<li class="chapter" data-level="7.1.1" data-path="hagyomanyos-grafika.html"><a href="hagyomanyos-grafika.html#grafikus-eszkozok"><i class="fa fa-check"></i><b>7.1.1</b> Grafikus eszközök</a></li>
<li class="chapter" data-level="7.1.2" data-path="hagyomanyos-grafika.html"><a href="hagyomanyos-grafika.html#az-eszkozfelulet-felosztasa"><i class="fa fa-check"></i><b>7.1.2</b> Az eszközfelület felosztása</a></li>
<li class="chapter" data-level="7.1.3" data-path="hagyomanyos-grafika.html"><a href="hagyomanyos-grafika.html#az-eszkozfelulet-reszei"><i class="fa fa-check"></i><b>7.1.3</b> Az eszközfelület részei</a></li>
<li class="chapter" data-level="7.1.4" data-path="hagyomanyos-grafika.html"><a href="hagyomanyos-grafika.html#magas-szintu-rajzfuggvenyek"><i class="fa fa-check"></i><b>7.1.4</b> Magas-szintű rajzfüggvények</a></li>
<li class="chapter" data-level="7.1.5" data-path="hagyomanyos-grafika.html"><a href="hagyomanyos-grafika.html#alacsony-szintu-rajzfuggvenyek"><i class="fa fa-check"></i><b>7.1.5</b> Alacsony-szintű rajzfüggvények</a></li>
<li class="chapter" data-level="7.1.6" data-path="hagyomanyos-grafika.html"><a href="hagyomanyos-grafika.html#interaktiv-grafikus-fuggvenyek"><i class="fa fa-check"></i><b>7.1.6</b> Interaktív grafikus függvények</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="a-modern-grafika-ggplot2.html"><a href="a-modern-grafika-ggplot2.html"><i class="fa fa-check"></i><b>7.2</b> A modern grafika (ggplot2)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="az-r-programozasa.html"><a href="az-r-programozasa.html"><i class="fa fa-check"></i><b>8</b> Az R programozása</a><ul>
<li class="chapter" data-level="8.1" data-path="blokk-utasitas.html"><a href="blokk-utasitas.html"><i class="fa fa-check"></i><b>8.1</b> Blokk utasítás</a></li>
<li class="chapter" data-level="8.2" data-path="felteteles-utasitasok.html"><a href="felteteles-utasitasok.html"><i class="fa fa-check"></i><b>8.2</b> Feltételes utasítások</a></li>
<li class="chapter" data-level="8.3" data-path="ciklus-utasitasok.html"><a href="ciklus-utasitasok.html"><i class="fa fa-check"></i><b>8.3</b> Ciklus utasítások</a></li>
<li class="chapter" data-level="8.4" data-path="fuggveny-letrehozasa.html"><a href="fuggveny-letrehozasa.html"><i class="fa fa-check"></i><b>8.4</b> Függvény létrehozása</a></li>
<li class="chapter" data-level="8.5" data-path="eleresi-ut.html"><a href="eleresi-ut.html"><i class="fa fa-check"></i><b>8.5</b> Elérési út</a></li>
<li class="chapter" data-level="8.6" data-path="hataskor.html"><a href="hataskor.html"><i class="fa fa-check"></i><b>8.6</b> Hatáskör</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="feladatok-megoldasa.html"><a href="feladatok-megoldasa.html"><i class="fa fa-check"></i><b>9</b> Feladatok megoldása</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R alapok I. - RNS szekvenálási példákkal</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hagyomanyos-grafika" class="section level2">
<h2><span class="header-section-number">7.1</span> Hagyományos grafika</h2>
<p>Az Alap R számos eljárást ad a grafikus ábrák létrehozására, sőt saját ábratípusokat is létrehozhatunk. A parancssorba gépelt <code>demo(graphics)</code> vagy <code>demo(persp)</code> függvényhívásokkal képet kaphatunk az R grafikus lehetőségeiről.</p>
<p>Az R segítségével grafikus eszközre (graphical device) rajzolhatunk, amely alapértelmezetten a képernyő, de egy adott típusú állomány is lehet. A grafikus (rajz)függvényeink két alapvető csoportba sorolhatók:</p>
<ul>
<li>magas-szintű (high-level) rajzfüggvények,</li>
<li>alacsony-szintű (low-level) rajzfüggvények.</li>
</ul>
<p>A hagyományos grafika jellemzője, hogy <em>grafikus paraméter</em>eket használ a rajzolás közben. Ezekről a paraméterekről a <code>?par</code> segítségével kapunk teljes listát, beállításuk és lekérdezésük a <code>par()</code> függvénnyel lehetséges. Például ha a <code>bg=</code> paraméter alapértelmezett fehér értékét megváltoztatjuk szürkére vagy kékre, akkor ugyanaz a rajzfügvény háttérszínben eltérő ábrát fog létrehozni.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb678-1" title="1"><span class="kw">par</span>(<span class="dt">bg=</span><span class="st">&quot;lightgray&quot;</span>); <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb678-2" title="2"><span class="kw">par</span>(<span class="dt">bg=</span><span class="st">&quot;lightblue&quot;</span>); <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/plot-alapbg2-abra-1.svg" width="33%" style="display: block; margin: auto;" /></p>
<p>Az alapértelmezett háttérszín értékét ne felejtsük visszaállítani: <code>par(bg="white")</code>.</p>
<div id="grafikus-eszkozok" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Grafikus eszközök</h3>
<p>Az R-ben megnyithatunk egy vagy több grafikus eszközt, ezekből mindig az egyik az aktuális (aktív), amelyre a grafikus függvényeinkkel rajzolhatunk. Az alapértelmezett grafikus eszközünk az R-ben a képernyő egy ablaka (windows), de több állománytípus (pl. jpeg, pdf, postscript) áll rendelkezésre, amelyekben létrehozhatjuk ábráinkat. A grafikus eszközök leírását a <code>?device</code> paranccsal érhetjük el.</p>
<p>Grafikus eszközt a típusuknak megfelelő függvényhívással hozhatunk létre. A következő sorban két windows és egy jpeg típusú grafikus eszközt hozunk létre:</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb679-1" title="1"><span class="kw">windows</span>(); <span class="kw">windows</span>(); <span class="kw">jpeg</span>(<span class="st">&quot;abra.jpg&quot;</span>)</a>
<a class="sourceLine" id="cb679-2" title="2"><span class="kw">dev.list</span>()</a></code></pre></div>
<p>Az <code>dev.list()</code> függvénnyel a megnyitott grafikus eszközeink listáját kapjuk meg: az eszköz típusát és azonosítóját látjuk a képernyőn. Az első megnyitott eszközünk 2-es azonosítót kapja.
A megnyitott eszközeink egyike az aktuális grafikus eszköz, az utoljára megnyitott eszköz lesz az aktuális. Az aktuális eszközt a <code>dev.cur()</code> függvénnyel kérdezhetjük le, beállítása a <code>dev.set()</code> függvénnyel lehetséges:</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb680-1" title="1"><span class="kw">dev.cur</span>()</a>
<a class="sourceLine" id="cb680-2" title="2"><span class="kw">dev.set</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb680-3" title="3"><span class="kw">dev.cur</span>()</a></code></pre></div>
<p>A grafikus eszközök bezárását a <code>dev.off()</code> függvény végzi. Paraméter nélkül az aktuális eszközt zárhatjuk be, numerikus paraméterrel pedig az adott sorszámú eszközt. A visszatérési értéke az aktuális grafikus eszköz. A <code>graphics.off()</code> az összes nyitott eszközt bezárja:</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb681-1" title="1"><span class="kw">dev.off</span>()</a>
<a class="sourceLine" id="cb681-2" title="2"><span class="kw">dev.off</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb681-3" title="3"><span class="kw">graphics.off</span>()</a></code></pre></div>
</div>
<div id="az-eszkozfelulet-felosztasa" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Az eszközfelület felosztása</h3>
<p>Nagyon hasznos lehetőség az R-ben, hogy a rajzterület felosztható különálló részekre (ablakokra), melyek mindegyikére a többitől függetlenül rajzolhatunk. A felosztásra több lehetőségünk is van, ezek nem minden esetben kompatibilisek egymással.</p>
<p>A legegyszerűbben a <code>mfrow=</code> vagy <code>mfcol=</code> grafikus paramétereket használhatjuk a felosztásra, egy kételemű numerikus vektor lehet az értékük, amelyek a felosztott ablakok sorainak és oszlopainak a számát határozzák meg.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb682-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</a></code></pre></div>
<p>A fenti sor hatására egy 3 sorból és 2 oszlopból álló, 6 elkülönült ablakot tartalmazó rajzterületet kapunk. Az <code>mfrow=</code> esetén a felosztás soronként, az <code>mfcol=</code> esetén pedig oszloponként történik.</p>
<p>Az aktuális felosztásról a <code>layout.show()</code> függvény ad tájékoztatást:</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb683-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)); <span class="kw">layout.show</span>(<span class="dv">6</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/felosztas-1-abra-1.svg" width="30%" style="display: block; margin: auto;" /></p>
<p>A függvény sorszámokkal azonosítja a különböző rajzterületeket, így azok beazonosíthatók, nagyságuk és elhelyezkedésük az ábráról leolvasható.</p>
<p>A fenti felosztás az <code>mfcol=</code> paraméter beállításával is elérhető, de ekkor a rajzterületek kiosztása oszloponként történik:</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb684-1" title="1"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)); <span class="kw">layout.show</span>(<span class="dv">6</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/felosztas-2-abra-1.svg" width="30%" style="display: block; margin: auto;" /></p>
<p>A felosztott rajzterületekre az ábrák rajzolása az azonosítók sorrendjében történik, először az 1-es sorszámú rajzterületre rajzolunk, majd a következő magas-szintű függvényhívás a 2-es sorszámú rajzterületre rajzol, és így tovább.
Ritkán előfordul, hogy a fenti sorrendet felül szeretnénk bírálni és azt szeretnénk, hogy a következő magas-szintű függvényünk egy adott (nem a sorrendben következő) rajzterületre vonatkozzon. Ekkor az <code>mfg=</code> paramétert használhatjuk az aktuális rajzterület beállítására.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb685-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">bg=</span><span class="st">&quot;lightgreen&quot;</span>)</a>
<a class="sourceLine" id="cb685-2" title="2"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)          <span class="co"># ábra az 1,1 pozícióba</span></a>
<a class="sourceLine" id="cb685-3" title="3"><span class="kw">par</span>(<span class="dt">mfg=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb685-4" title="4"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)          <span class="co"># ábra a 2,3 pozícióba</span></a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/felosztas-mfg-abra-1.svg" width="50%" style="display: block; margin: auto;" /></p>
<p>A fenti példában arról rendelkezünk, hogy a 2. sor 3. oszlopába kerüljön a következő ábra. A 4 elemű numerikus vektor utolsó két értéke csak megismétli a felosztás tényét, miszerint a rajzterület 2 sor és 3 oszlop mentén lett felosztva.</p>
<p>A felosztás megszüntetése az egy sorból és egy oszlopból álló “felosztás” beállítását jelenti:</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb686-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))  <span class="co"># felosztás megszüntetése</span></a></code></pre></div>
<p>A rajzterület rugalmasabb felosztását teszi lehetővé a <code>layout()</code> függvény, amely a paraméterében szereplő mátrix értékei mentén végzi a felosztást. A rajzterület részei eltérő méretűek is lehetnek, valamint gondoskodhatunk az egymás melletti részek egyesítéséről is.</p>
<p>A <code>mfcol=</code> paraméter használatánál szereplő felosztást a következő <code>layout()</code> függvényhívás hajtja végre:</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb687-1" title="1"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dt">ncol=</span><span class="dv">2</span>)); <span class="kw">layout.show</span>(<span class="dv">6</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/felosztas-lo-1-abra-1.svg" width="30%" style="display: block; margin: auto;" /></p>
<p>Ha eltérő nagyságú területekre szeretnénk felosztani a rajzunkat, akkor a widths és a heights paraméterekkel állíthatjuk be az oszlopok és a sorok egymáshoz viszonyított arányát.</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb688-1" title="1"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">ncol=</span><span class="dv">2</span>), <span class="dt">widths=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">heights=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb688-2" title="2"><span class="kw">layout.show</span>(<span class="dv">4</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/felosztas-lo-2-abra-1.svg" width="30%" style="display: block; margin: auto;" /></p>
<p>A felosztás itt egy 2x2-es mátrix alapján történik, ahol a <code>widths=</code> paraméter a két oszlop szélességét állítja be: a második oszlop az első oszlop szélességének kétszerese. A <code>heights=</code> paraméter hasonlóan határozza meg a sorok magasságát.
A <code>layout()</code> függvény első paraméterében szereplő mátrix azonos értékeket is tartalmazhat, ekkor egymás melletti rajzterületek összevonására van lehetőségünk:</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb689-1" title="1"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">3</span>),<span class="dt">ncol=</span><span class="dv">2</span>), <span class="dt">widths=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">heights=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb689-2" title="2"><span class="kw">layout.show</span>(<span class="dv">3</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/felosztas-lo-3-abra-1.svg" width="30%" style="display: block; margin: auto;" /></p>
<p>A fenti két felosztási módszertől alapjaiban eltérő a <code>split.screen()</code> függvénnyel történő felosztás.</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb690-1" title="1"><span class="kw">split.screen</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</a></code></pre></div>
<p>A példában 2 sor és 1 oszlop mentén a rajzterületet egy felső és alsó részre osztottuk. Ezek azonosítója a visszatérési értéknek megfelelően 1 és 2. Az azonosítókat felhasználhatjuk az adott rajzterület továbbosztásához:</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb691-1" title="1"><span class="kw">split.screen</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">screen=</span><span class="dv">2</span>)</a></code></pre></div>
<p>A 2-es rajzterületet osztjuk 1 sor és 3 oszlop mentén három egyenlő részre, ezek új azonosítóival tér vissza a függvény. A rajzterület kiválasztását a <code>screen()</code> függvénnyel végezzük, paraméterben egy rajzterület azonosítóját kell megadnunk. Rajzterület tartalmát az <code>erase.screen()</code> függvénnyel törölhetjük, a rajzterület felosztásából a <code>close.screen()</code> függvénnyel léphetünk ki.</p>
</div>
<div id="az-eszkozfelulet-reszei" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Az eszközfelület részei</h3>
<p>Az eszközfelületen egyetlen ábra létrehozásakor a következő részeket különböztethetjük meg: külső margó, ábraterület, belső margó, rajzterület. A <a href="hagyomanyos-grafika.html#fig:eszkozterulet-abra">7.1</a> ábrán belülről kifelé haladva a rajzterület és a belső margó látható, melyek együtt egy olyan ábraterületet alkotnak, amely teljesen kitölti az eszközfelületet. Külső margó alapértelmezés szerint nincs, ezt magunknak kell beállítani.</p>
<div class="figure" style="text-align: center"><span id="fig:eszkozterulet-abra"></span>
<img src="r_bioinf_files/figure-html/eszkozterulet-abra-1.svg" alt="Az eszközterület részei (külső margó nélkül)" width="60%" />
<p class="caption">
ÁBRA 7.1: Az eszközterület részei (külső margó nélkül)
</p>
</div>
<p>A rajzterületre kerülnek az ábrázolandó pontok, vonalak, görbék, 2 és 3 dimenziós alakzatok. A belső margón foglal helyet az ábra címe és alcíme, a tengelyek feliratai, a beosztások címkéi és maguk a beosztások is. A rajzterület és a belső margó határán helyezkedik el a két tengely, valamint a rajzterületet körbevevő szegély is.
A belső margók a <code>mai=</code> (inch-ben mért) és <code>mar=</code> (szövegsorokban mért) paraméterek segítségével kérdezhetők le és állíthatók be.</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb692-1" title="1"><span class="kw">par</span>(<span class="kw">c</span>(<span class="st">&quot;mai&quot;</span>, <span class="st">&quot;mar&quot;</span>)) <span class="co"># belső margók lekérdezése</span></a></code></pre></div>
<pre><code>## $mai
## [1] 1.02 0.82 0.82 0.42
## 
## $mar
## [1] 5.1 4.1 4.1 2.1</code></pre>
<p>A kapott értékek rendre az alsó, bal oldali, felső és jobb oldali margókat jelentik.</p>
<p>A külső margók az <code>omi=</code> és az <code>oma=</code> paraméterek segítségével kezelhetők és mint láttuk alapértelmezetten nem kerülnek beállításra:</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb694-1" title="1"><span class="kw">par</span>(<span class="kw">c</span>(<span class="st">&quot;omi&quot;</span>, <span class="st">&quot;oma&quot;</span>)) <span class="co"># külső margók lekérdezése</span></a></code></pre></div>
<pre><code>## $omi
## [1] 0 0 0 0
## 
## $oma
## [1] 0 0 0 0</code></pre>
<p>Az <code>omi=</code> az inch-ben mért, az <code>oma=</code> pedig a szövegsorban mért margónagyságot határozza meg. Ha 2 szövegsornyira állítjuk mindegyik külső margót</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb696-1" title="1"><span class="kw">par</span>(<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span> ,<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb696-2" title="2"><span class="kw">par</span>(<span class="kw">c</span>(<span class="st">&quot;omi&quot;</span>, <span class="st">&quot;oma&quot;</span>))</a></code></pre></div>
<pre><code>## $omi
## [1] 0.4 0.4 0.4 0.4
## 
## $oma
## [1] 2 2 2 2</code></pre>
<p>akkor az eszközfelület a <a href="hagyomanyos-grafika.html#fig:eszkozterulet-kulsomargo-abra">7.2</a> ábrának megfelelően épül fel.</p>
<div class="figure" style="text-align: center"><span id="fig:eszkozterulet-kulsomargo-abra"></span>
<img src="r_bioinf_files/figure-html/eszkozterulet-kulsomargo-abra-1.svg" alt="Az eszközterület külső margóval" width="60%" />
<p class="caption">
ÁBRA 7.2: Az eszközterület külső margóval
</p>
</div>
<p>A margókban (külső vagy belső) szöveges információt az <code>mtext()</code> függvénnyel helyezhetünk el. Az <code>side=</code> paraméter a margó kiválasztását jelenti (1=alsó, 2=bal, 3=felső, 4=jobb), a <code>line=</code> paraméterrel a margó szövegsorát adjuk meg (0-val kezdődik), az <code>outer=</code> paraméter pedig a külső vagy belső margó közötti választásról gondoskodik (<code>TRUE</code>=külső margó, <code>FALSE</code>=belső margó). A külső és belső margóba írhatunk a következő parancsokkal:</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb698-1" title="1"><span class="kw">mtext</span>(<span class="st">&quot;Külső margó&quot;, outer=T, line=2)</span></a>
<a class="sourceLine" id="cb698-2" title="2"><span class="st">mtext(&quot;</span>Belső margó&quot;, <span class="dt">outer=</span>F, <span class="dt">line=</span><span class="dv">1</span>)</a></code></pre></div>
<p>A belső és külső margóba írható szövegsorokról a <a href="hagyomanyos-grafika.html#fig:eszkozterulet-kulsomargo-sorok-abra">7.3</a> ábra tájékoztatást. Az <code>mtext()</code> függvény <code>line=</code> paramétere határozza meg a szöveg helyét, az <code>adj=</code> paraméter a szöveg igazítását (a tengelyekkel párhuzamos irányban az <code>adj=0</code> balra igazít, <code>adj=1</code> jobbra igazít).</p>
<div class="figure" style="text-align: center"><span id="fig:eszkozterulet-kulsomargo-sorok-abra"></span>
<img src="r_bioinf_files/figure-html/eszkozterulet-kulsomargo-sorok-abra-1.svg" alt="Szövegsorok a külső és belső margón" width="60%" />
<p class="caption">
ÁBRA 7.3: Szövegsorok a külső és belső margón
</p>
</div>
<p>Amennyiben az eszközfelületünket több ablakra osztjuk az alapértelmezett felosztásban az ablakokban egy-egy ábraterület található, amelyek belső margóval és rajzterülettel rendelkeznek (<a href="hagyomanyos-grafika.html#fig:eszkozterulet-tobb-abra">7.4</a>. ábra).</p>
<div class="figure" style="text-align: center"><span id="fig:eszkozterulet-tobb-abra"></span>
<img src="r_bioinf_files/figure-html/eszkozterulet-tobb-abra-1.svg" alt="Szövegsorok a külső és belső margón" width="70%" />
<p class="caption">
ÁBRA 7.4: Szövegsorok a külső és belső margón
</p>
</div>
<p>A külső margó most is hiányzik, de a szokásos grafikus paraméterek segítségével beállíthatjuk, ekkor a <a href="hagyomanyos-grafika.html#fig:eszkozterulet-tobb-kulsomargo-abra">7.5</a> ábrának megfelelő felosztást kapjuk.</p>
<div class="figure" style="text-align: center"><span id="fig:eszkozterulet-tobb-kulsomargo-abra"></span>
<img src="r_bioinf_files/figure-html/eszkozterulet-tobb-kulsomargo-abra-1.svg" alt="Szövegsorok a külső és belső margón" width="70%" />
<p class="caption">
ÁBRA 7.5: Szövegsorok a külső és belső margón
</p>
</div>
<p>Természetesen a margókba most is írhatunk tetszőleges szöveget az <code>mtext()</code> függvény segítségével a <a href="hagyomanyos-grafika.html#fig:eszkozterulet-tobb-kulsomargo-szovegsorok-abra">7.6</a> ábrának megfelelően.</p>
<div class="figure" style="text-align: center"><span id="fig:eszkozterulet-tobb-kulsomargo-szovegsorok-abra"></span>
<img src="r_bioinf_files/figure-html/eszkozterulet-tobb-kulsomargo-szovegsorok-abra-1.svg" alt="Szövegsorok a külső és belső margón" width="70%" />
<p class="caption">
ÁBRA 7.6: Szövegsorok a külső és belső margón
</p>
</div>
</div>
<div id="magas-szintu-rajzfuggvenyek" class="section level3">
<h3><span class="header-section-number">7.1.4</span> Magas-szintű rajzfüggvények</h3>
<p>A magas-szintű rajzfüggvények az aktív grafikai eszközön hoznak létre új ábrát, ami a legtöbbször a régi tartalom törlésével jár. Az ábrához többek között tengelyek, címkék és feliratok tartoznak, amelyek megjelenítéséről a grafikai paraméterekkel gondoskodhatunk.</p>
<p>A legtöbbször használt magas-szintű függvények:</p>
<ul>
<li><code>stripchart()</code> - egydimenziós pontdiagram</li>
<li><code>plot()</code> - kétdimenziós pontdiagram, vonaldiagram</li>
<li><code>hist()</code> - hisztogram</li>
<li><code>barplot()</code> - oszlopdiagram</li>
<li><code>boxplot()</code> - dobozdiagram</li>
<li><code>curve()</code> - függvény ábrázolása</li>
<li><code>pie()</code> - kördiagram</li>
</ul>
<div id="a-stripchart-fuggveny" class="section level4">
<h4><span class="header-section-number">7.1.4.1</span> A <code>stripchart()</code> függvény</h4>
<p>A <code>stripchart()</code> legegyszerűbb formájában egyetlen numerikus változó értékeit jeleníti meg, horizontálisan, egymásra rajzolt négyzet pontkarakterekkel. A <strong>MASS</strong> csomag <code>survey</code> adatbázisát használjuk, és testmagasságokat jelenítünk meg cm-ben mérve.</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb699-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb699-2" title="2"><span class="kw">stripchart</span>(<span class="dt">x =</span> survey<span class="op">$</span>Height)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/strip-simple-abra-1.svg" width="60%" style="display: block; margin: auto;" /></p>
<p>A horizontális megjelenítést vertikálisra (<code>vertical = T</code>), a négyzetet pedig színezett pontokra cseréljük (<code>pch=21, col="blue", bg="lightblue"</code>), és elvetjük a pontok egymásra rajzolását (<code>method = "jitter"</code>).</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb700-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb700-2" title="2"><span class="kw">stripchart</span>(<span class="dt">x =</span> survey<span class="op">$</span>Height, <span class="dt">vertical =</span> T, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/strip-p2-abra-1.svg" width="60%" style="display: block; margin: auto;" /></p>
<p>A <code>pch=</code> paraméter lehetséges értékeiről lesz még szó később. Figyeljük meg, hogy a <code>bg=</code> (és a <code>col=</code> is) más jelentésű a <code>par()</code> argumentumaként, és más jelentésű a magas-szintű függvények argumentumában. Minden magas-szintű függvényben, így a <code>strripchart()</code>-ban is a rajzterületen megjelenített grafikus elem háttérszínét és vonalszínét határozza meg. Ez a két argumentum (<code>bg=</code> és <code>col=</code>) tehát általánosan használható minden más magas-szintű függvényben is. A <code>vertical=</code> és a <code>method=</code> azonban inkább az egydimenziós pontdiagramra jellemző beállítások.</p>
<p>Melyek a legfontosabb általános, minden magas-szintű függvényben használható paraméterek:</p>
<ul>
<li><code>main=</code><br />
Az ábra címe, felül, középen, kielmelten fog megjelenni.</li>
<li><code>sub=</code><br />
Az ábra alcíme, amely az ábra alján jelenik meg.</li>
<li><code>xlab=</code>, <code>ylab=</code><br />
Az x és y tengely felirata, ha elhagyjuk, akkor az ábrázolt objektum nevét olvashatjuk.</li>
<li><code>xlim=</code>, <code>ylim=</code><br />
Az x és y tengelyek ábrázolási tartományát határozzuk meg. Értékeik egy-egy kételemű numerikus vektor, melyek az ábrázolt intervallum alsó és felső határait adják.</li>
<li><code>fg=</code>, <code>bg=</code>,<code>col=</code>, <code>col.axis=</code>, <code>col.lab=</code>, <code>col.main=</code>, <code>col.sub=</code><br />
Az ábra színeinek megadására használt paraméterek.</li>
<li><code>main=</code><br />
Az ábra címe, felül, középen, kielmelten fog megjelenni.</li>
<li><code>sub=</code><br />
Az ábra alcíme, amely az ábra alján jelenik meg.</li>
<li><code>xlab=</code>, <code>ylab=</code><br />
Az x és y tengely felirata, ha elhagyjuk, akkor az ábrázolt objektum nevét olvashatjuk.</li>
<li><code>xlim=</code>, <code>ylim=</code><br />
Az x és y tengelyek ábrázolási tartományát határozzuk meg. Értékeik egy-egy kételemű numerikus vektor, melyek az ábrázolt intervallum alsó és felső határait adják.</li>
<li><code>axes=</code><br />
A tengelyek és a rajzterületet szegélyeinek megjelenítését szabályozzuk. Alapértelmezett értéke <code>TRUE</code>. Ha <code>FALSE</code> értéket adunk, akkor az <code>axis()</code> és a <code>box()</code> függvényekkel a tengelyeket és a szegélyt később is megrajzolhatjuk.</li>
<li><p><code>bty=</code><br />
A rajzterület szegélyezését állíthatjuk be. Értéke egy karakter lehet, melyek jelentése a következő:</p>
<ul>
<li><code>"o"</code> teljes keretet rajzol</li>
<li><code>"l"</code> bal oldalt és lent lesz csak szegély</li>
<li><code>"7"</code> fent és jobboldalt rajzol keretet</li>
<li><code>"c"</code> alul, baloldalt és felül lesz rajzol szegélyt</li>
<li><code>"u"</code> baloldalt, alul és jobboldalt kapunk keretet</li>
<li><code>"]"</code> felül, jobboldalt és alul jelenik meg szegély</li>
<li><code>"n"</code> nem jelenít meg szegélyt</li>
</ul></li>
<li><code>las=</code><br />
Az x és y tengelyek címkéi lehetnek párhuzamosak és merőlegesek a tengelyeikre nézve. A lehetséges eseteknek megfelelően a paraméter értéke lehet:
<ul>
<li><code>0=</code> párhuzamosak a tengelyükkel (alapértelmezés)</li>
<li><code>1=</code> x-re párhuzamos, y-ra merőleges</li>
<li><code>2=</code> merőlegesek a tengelyükre</li>
<li><code>3=</code> x-re merőleges, y-ra párhuzamos</li>
</ul></li>
<li><code>pch=</code> A kirajzolt pont határozza meg. Értéke vagy egy karakter és ekkor az lesz a megjelenített pont alakja, vagy tipikusan egy skalár 0 és 25 között.</li>
<li><code>cex=</code>, <code>cex.axis=</code>, <code>cex.lab=</code>, <code>cex.main=</code>, <code>cex.sub=</code><br />
Az egyes összetevők relatív mérete</li>
<li><p><code>family=</code>, <code>font=</code>, <code>font.axis=</code>, <code>font.lab=</code>, <code>font.main=</code>, <code>font.sub=</code><br />
Az egyes összetevők betűtípusa</p></li>
</ul>
<p>A fenti paraméterek felhasználásával készítsünk egy kicsit szebb ábrát.</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb701-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb701-2" title="2"><span class="kw">stripchart</span>(<span class="dt">x =</span> survey<span class="op">$</span>Height, <span class="dt">vertical =</span> T, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Főcím: Testmagasság eloszlása&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;Alcím: Egyetemi hallgatók adatai&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Testmagasság (cm)&quot;</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/strip-p3-abra-1.svg" width="60%" style="display: block; margin: auto;" /></p>
<p>A további szépítéshez a korábban megismert grafikus paramétereket kell használnunk. Érdemes megváltoztatni a margót (<code>mar=</code>), a tengelybeosztás címkéinek írásirányát (<code>las=</code>), a tengelyfeliratok és a tengelybeosztás címkéinek távolságát a tengelyektől (<code>mgp=</code>), valamint a beosztások mértetét (<code>tcl=</code>).</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb702-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb702-2" title="2"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.9</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb702-3" title="3"><span class="kw">par</span>(<span class="dt">las=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb702-4" title="4"><span class="kw">par</span>(<span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">1.9</span>, <span class="fl">0.1</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb702-5" title="5"><span class="kw">par</span>(<span class="dt">tcl=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb702-6" title="6"><span class="kw">stripchart</span>(<span class="dt">x =</span> survey<span class="op">$</span>Height, <span class="dt">vertical =</span> T, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Főcím: Testmagasság eloszlása&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;Alcím: Egyetemi hallgatók adatai&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Testmagasság (cm)&quot;</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/strip-p4-abra-1.svg" width="60%" style="display: block; margin: auto;" /></p>
<p>Végül használjuk a szokásos formula argumentumot az <code>x=</code> argumentumban (<code>Height~Sex</code>), amely ebben az esetben a <code>data=</code> argumentum megadását is szükségessé teszi. Az ábrán külön jelennek meg a nők és férfiak testmagasságai. A megjelenítéshez tartozó <code>ylim=</code> paraméteren is változtassunk, az y tengely láthatósági tartományát állítsuk be 140 és 210 közé (<code>ylim=c(140, 210)</code>)</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb703-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb703-2" title="2"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">3.9</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb703-3" title="3"><span class="kw">par</span>(<span class="dt">las=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb703-4" title="4"><span class="kw">par</span>(<span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">1.9</span>, <span class="fl">0.1</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb703-5" title="5"><span class="kw">par</span>(<span class="dt">tcl=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb703-6" title="6"><span class="kw">stripchart</span>(<span class="dt">x =</span> Height<span class="op">~</span>Sex, <span class="dt">data=</span>survey, <span class="dt">vertical =</span> T, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Főcím: Testmagasság eloszlása&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;Alcím: Egyetemi hallgatók adatai&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Testmagasság (cm)&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">140</span>, <span class="dv">210</span>))</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/strip-p5-abra-1.svg" width="60%" style="display: block; margin: auto;" /></p>
<p>Egy másik példában egy üzletben eladott kalapácsok számát rögzítettük 25 napon keresztül. A <code>method=</code> argumentum <code>"stack"</code> értékével érjük el, hogy egymásra halmazza az azonos pontokat. Ez nagyon jól jöhet diszkrét változók eloszlásának megismeréséhez.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb704-1" title="1"><span class="kw">library</span>(extrafont)</a>
<a class="sourceLine" id="cb704-2" title="2"><span class="co"># font_import() # 1x kell végrehajtani</span></a>
<a class="sourceLine" id="cb704-3" title="3"><span class="co"># fonts()       # tájékozódhatunk az elérhető fontokról</span></a>
<a class="sourceLine" id="cb704-4" title="4"><span class="kw">loadfonts</span>(<span class="dt">device=</span><span class="st">&quot;win&quot;</span>, <span class="dt">quiet =</span> T)</a>
<a class="sourceLine" id="cb704-5" title="5"><span class="kw">par</span>(<span class="dt">family=</span><span class="st">&quot;Times New Roman&quot;</span>)</a>
<a class="sourceLine" id="cb704-6" title="6">mh &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>,  <span class="dv">6</span>, <span class="dv">12</span>,  <span class="dv">6</span>,  <span class="dv">9</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">11</span>,  <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">12</span>,  <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb704-7" title="7">        <span class="dv">10</span>, <span class="dv">10</span>,  <span class="dv">6</span>, <span class="dv">12</span>,  <span class="dv">6</span>,  <span class="dv">9</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">11</span>,  <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">12</span>,  <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb704-8" title="8"><span class="kw">stripchart</span>(mh, <span class="dt">method=</span><span class="st">&quot;stack&quot;</span>, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">offset=</span><span class="dv">2</span><span class="op">/</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">axes=</span>F, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1500000</span>))</a>
<a class="sourceLine" id="cb704-9" title="9"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> mh)</a>
<a class="sourceLine" id="cb704-10" title="10"><span class="kw">box</span>()</a>
<a class="sourceLine" id="cb704-11" title="11"><span class="kw">title</span>(<span class="dt">main=</span><span class="st">&quot;Eladások&quot;</span>, <span class="dt">family=</span><span class="st">&quot;Calibri&quot;</span>, <span class="dt">cex.main=</span><span class="fl">1.3</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/strip-p6-abra-1.svg" width="60%" style="display: block; margin: auto;" /></p>
<p>A fenti ábra elkészítéséhez</p>
<p>A fenti ábrában használt globális paramétereket és <code>stripchart()</code> függvényhívásban megjelenő általános argumentumokat minden további ábrában felhasználhatjuk esztétikus grafika létrehozására. Az áttekinthetőség miatt ezeket a továbbiakban mellőzzük, de a publikációban felhasznált ábrák természetesen ezeket a beállításokat nem nélkülözhetik.</p>
</div>
<div id="a-plot-fuggveny" class="section level4">
<h4><span class="header-section-number">7.1.4.2</span> A <code>plot()</code> függvény</h4>
<p>A <code>plot()</code> az R legalapvetőbb függvénye ábrák létrehozására. Egyik legegyszerűbb felhasználása, hogy az x és y tengelyek mentén a függvény bemeneti paramétereiben meghatározott értékpárokhoz (mint x és y értékekhez) egy-egy pontot jelenítsen meg az ábrán (<a href="hagyomanyos-grafika.html#fig:plot-alap-abra">7.7</a> ábra):</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb705-1" title="1">x&lt;-<span class="dv">21</span><span class="op">:</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb705-2" title="2">y&lt;-<span class="dv">51</span><span class="op">:</span><span class="dv">60</span></a>
<a class="sourceLine" id="cb705-3" title="3"><span class="kw">plot</span>(x,y)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-alap-abra"></span>
<img src="r_bioinf_files/figure-html/plot-alap-abra-1.svg" alt="Egyszerű kétdimenziós pontdiagram" width="60%" />
<p class="caption">
ÁBRA 7.7: Egyszerű kétdimenziós pontdiagram
</p>
</div>
<p>Az <code>x</code> és <code>y</code> numerikus vektorok 10-10 eleműek, a <a href="hagyomanyos-grafika.html#fig:plot-alap-abra">7.7</a> ábrán is 10 pontot látunk. Az első pontnak megfelelő pontkarakter a (21, 51) koordinátájú pontban rajzolódik ki, ezek a koordináták az <code>x</code> és <code>y</code> vektor első elemei. A második kis karika rajzolásához a numerikus vektorok 2. elemeit használja a <code>plot()</code>, ez a (22, 52) koordinátájú pont lesz. A többi 8 pont is hasonlóan, az azonos pozíción lévő vektorelemeknek megfelelő értékpárok alapján jelenik meg az ábrán.</p>
<p>A <code>plot()</code> függvény egyetlen vektorral is hívható:</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb706-1" title="1">y &lt;-<span class="st"> </span><span class="dv">21</span><span class="op">:</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb706-2" title="2"><span class="kw">plot</span>(x)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-egykoordinata-plot"></span>
<img src="r_bioinf_files/figure-html/plot-egykoordinata-plot-1.svg" alt="étdimenziós pontdiagram egy vektorból" width="60%" />
<p class="caption">
ÁBRA 7.8: étdimenziós pontdiagram egy vektorból
</p>
</div>
<p>A <a href="hagyomanyos-grafika.html#fig:plot-egykoordinata-plot">7.8</a> ábrán a <code>plot()</code> függvény a bemeneti <code>y</code> vektor alapján jelenít meg 10 pontot. A pontok megjelenítéséhez szükséges két koordináta közül most csak az egyik az y koordináta áll rendelkezésre, ezt éppen az <code>y</code> vektor elemei alkotják. Az x koordináták az <code>y</code> vektor indexeiből állnak, amely egy 10 elemű vektor esetén az 1,2, …, 10 elemeket jelenti. Az első ábrázolt pont koordinátái ennek megfelelően az (1, 21), a második (2, 22) és így tovább, az utolsó (10, 30).</p>
<p>A <code>plot()</code> függvény paraméterében a numerikus vektorok helyett faktorok is szerepelhetnek. Ha egyetlen faktorral hívjuk, akkor oszlopdiagramot kapunk, ha faktorral és numerikus vektorral, akkor dobozdiagramot kapunk. Ezeket az eseteket foglalja össze a <a href="hagyomanyos-grafika.html#fig:plot-tobb-abra">7.9</a> ábra.</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb707-1" title="1"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">byrow=</span>T))</a>
<a class="sourceLine" id="cb707-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb707-3" title="3">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb707-4" title="4">f &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb707-5" title="5"><span class="kw">plot</span>(x, <span class="dt">main=</span><span class="st">&quot;Egy változó&quot;, xlab=&quot;</span>Az x vektor indexei<span class="st">&quot;)</span></a>
<a class="sourceLine" id="cb707-6" title="6"><span class="st">plot(f, main=&quot;</span>Egy változó&quot;, <span class="dt">sub=</span><span class="st">&quot;Kategorikus változó&quot;, las=1, col=&quot;</span>red<span class="st">&quot;, pch=16, ylim=c(0, 8))</span></a>
<a class="sourceLine" id="cb707-7" title="7"><span class="st">plot(cbind(x,y), main=&quot;</span>Két változó&quot;,  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">bty=</span><span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb707-8" title="8"><span class="kw">plot</span>(y<span class="op">~</span>f, <span class="dt">main=</span><span class="st">&quot;Két változó&quot;, xlab=&quot;</span>Kategórikus változó&quot;, <span class="dt">ylab=</span><span class="st">&quot;Kvantitatív változó&quot;, ylim=c(-3,3))</span></a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-tobb-abra"></span>
<img src="r_bioinf_files/figure-html/plot-tobb-abra-1.svg" alt="étdimenziós pontdiagram egy vektorból" width="60%" />
<p class="caption">
ÁBRA 7.9: étdimenziós pontdiagram egy vektorból
</p>
</div>
<p>A <a href="hagyomanyos-grafika.html#fig:plot-tobb-abra">7.9</a> ábra megjelenítéséhez a <code>plot()</code> függvényekben a <code>stripchart()</code>-nál ismertetett paramétereket használtuk.</p>
<p>A <code>plot()</code> függvény fontos argumentuma a <code>type=</code>, amelyikkel jelentősen módosíthatjuk azonos adatok esetén is a megjelenítést. A lehetséges értékeket és a hozzájuk tartozó megjelenítést a <a href="#fig:plot-tipus-abra"><strong>??</strong></a> ábra tartalmazza.</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb708-1" title="1"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,<span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">byrow=</span>T))</a>
<a class="sourceLine" id="cb708-2" title="2">x&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>; y&lt;-<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dt">lambda=</span><span class="dv">5</span>); m&lt;-<span class="kw">cbind</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y<span class="dv">-5</span>)</a>
<a class="sourceLine" id="cb708-3" title="3"><span class="kw">plot</span>(m,<span class="dt">type=</span><span class="st">&quot;p&quot;</span>,<span class="dt">main=</span><span class="st">&#39;type=&quot;p&quot;&#39;</span>)</a>
<a class="sourceLine" id="cb708-4" title="4"><span class="kw">plot</span>(m,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&#39;type=&quot;l&quot;&#39;</span>)</a>
<a class="sourceLine" id="cb708-5" title="5"><span class="kw">plot</span>(m,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">main=</span><span class="st">&#39;type=&quot;b&quot;&#39;</span>)</a>
<a class="sourceLine" id="cb708-6" title="6"><span class="kw">plot</span>(m,<span class="dt">type=</span><span class="st">&quot;c&quot;</span>,<span class="dt">main=</span><span class="st">&#39;type=&quot;c&quot;&#39;</span>)</a>
<a class="sourceLine" id="cb708-7" title="7"><span class="kw">plot</span>(m,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">main=</span><span class="st">&#39;type=&quot;o&quot;&#39;</span>)</a>
<a class="sourceLine" id="cb708-8" title="8"><span class="kw">plot</span>(m,<span class="dt">type=</span><span class="st">&quot;h&quot;</span>,<span class="dt">main=</span><span class="st">&#39;type=&quot;h&quot;&#39;</span>)</a>
<a class="sourceLine" id="cb708-9" title="9"><span class="kw">plot</span>(m,<span class="dt">type=</span><span class="st">&quot;s&quot;</span>,<span class="dt">main=</span><span class="st">&#39;type=&quot;s&quot;&#39;</span>)</a>
<a class="sourceLine" id="cb708-10" title="10"><span class="kw">plot</span>(m,<span class="dt">type=</span><span class="st">&quot;S&quot;</span>,<span class="dt">main=</span><span class="st">&#39;type=&quot;S&quot;&#39;</span>)</a>
<a class="sourceLine" id="cb708-11" title="11"><span class="kw">plot</span>(m,<span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">main=</span><span class="st">&#39;type=&quot;n&quot;&#39;</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/plot-tipus-abra-1.svg" width="672" /></p>
</div>
<div id="a-curve-fuggveny" class="section level4">
<h4><span class="header-section-number">7.1.4.3</span> A <code>curve()</code> függvény</h4>
<p>A <code>curve()</code> függvény segítségével egy x-ben változó függvény grafikonját rajzolhatjuk meg. Az első argumentum kifejezése írja le az ábrázolandó függvényt, amely R-beli matematikai függvények nevét is tartalmazhatja. A <code>from=</code> és <code>to=</code> paraméterek határozzák meg a megjelenítés értelmezési tartományát, az <code>n=</code> paraméter pedig, hogy összesen hány behelyettesítés történjen a függvénybe. A <a href="#curve-abra"><strong>??</strong></a> ábra tartalmaz néhány példát a <code>curve()</code> függvény használatára.</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb709-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb709-2" title="2"><span class="kw">curve</span>(<span class="dv">12</span><span class="op">*</span>x<span class="op">**</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>x<span class="dv">-1</span>, <span class="dt">from=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">to=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb709-3" title="3"><span class="kw">curve</span>(sin, <span class="dt">from=</span><span class="op">-</span><span class="dv">5</span>, <span class="dt">to=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb709-4" title="4"><span class="kw">curve</span>(<span class="kw">sin</span>(x)<span class="op">/</span>x, <span class="dt">from=</span><span class="op">-</span><span class="dv">20</span>, <span class="dt">to=</span><span class="dv">20</span>, <span class="dt">n=</span><span class="dv">200</span>)</a>
<a class="sourceLine" id="cb709-5" title="5"><span class="kw">curve</span>(<span class="kw">dnorm</span>(x,<span class="dt">mean=</span><span class="dv">5</span>,<span class="dt">sd=</span><span class="dv">2</span>),<span class="dt">from=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">to=</span><span class="dv">11</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-233-1.svg" width="672" /></p>
</div>
<div id="a-hist-fuggveny" class="section level4">
<h4><span class="header-section-number">7.1.4.4</span> A <code>hist()</code> függvény</h4>
<p>A <code>hist()</code> függvény segítségével hisztogramot rajzolhatunk, azaz bizonyos osztályintervallumokhoz tartozó téglalapokat láthatunk egymás mellet, melyek területükkel jelzik az osztályintervallum (relatív)gyakoriságát. Az osztályintervallumok létrehozását a bemenő adatvektor alapján a <code>hist()</code> függvény is végezheti, de tipikusabb a <code>breaks=</code> paraméterrel vezérelni az intervallumok létrehozását. A <code>hist()</code> függvény legfontosabb argumentumai a következők:</p>
<ul>
<li><p><code>breaks=</code><br />
Az értéke lehet:</p>
<ul>
<li>skalár (ekkor az osztályintervallumok számát jelenti),</li>
<li>numerikus vektor (az osztályintervallumok határai),</li>
<li>karaktersorozat (az osztályhatárok megállapítására használt algoritmus neve (“Sturges”, “Scott”, “FD” / “Freedman-Diaconis”) vagy</li>
<li><ol start="4" style="list-style-type: decimal">
<li>egy saját függvény neve, amely az osztályokat létrehozza.</li>
</ol></li>
</ul></li>
<li><p><code>freq=</code><br />
Gyakoriság (<code>TRUE</code>) vagy relatív gyakoriság (<code>FALSE</code>) megjelenítése között választhatunk a paraméter segítségével. Alapértelmezetten <code>TRUE</code>, de ha nem azonos nagyságúk az osztályintervallumok, akkor <code>FALSE</code> lesz az alapértelmezett értéke.</p></li>
<li><p><code>right=</code><br />
Az osztályintervallumok bal vagy jobb oldali zártságát szabályozhatjuk vele. Alapértelmezett értéke <code>TRUE</code>, ami jobb oldali zártságot jelent, azaz ezek az értékek még az osztályhoz tartoznak.</p></li>
<li><p><code>include.lowest=</code><br />
Amennyiben a <code>right=</code> értéke <code>TRUE</code> és a legkisebb érték az első osztályintervallum bal szélső értéke, akkor az argumentum <code>TRUE</code> értéke esetén (ez az alapértelmezett) az osztályintervallumhoz sorolja a függvény ezt az elemet is. Ha a <code>right=</code> értéke <code>FALSE</code> (jobb oldali nyitottság), akkor mindez a legnagyobb értékre és az utolsó osztály jobb szélső értékére értendő.</p></li>
<li><p><code>plot=</code><br />
Ha megváltoztatjuk az alapértelmezett <code>TRUE</code> értéket <code>FALSE</code>-ra, akkor nem történik meg a hisztogram kirajzolása, hanem a visszatérési értékkel (ami egy lista) dolgozhatunk tovább.</p></li>
<li><p><code>labels=</code><br />
Az oszlopok tetején (relatív)gyakoriságot jelenít meg.</p></li>
</ul>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb710-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb710-2" title="2">x&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb710-3" title="3">rx&lt;-<span class="kw">rpois</span>(<span class="dv">120</span>, <span class="dt">lambda=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb710-4" title="4"><span class="kw">hist</span>(x,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="dt">labels=</span>T)</a>
<a class="sourceLine" id="cb710-5" title="5"><span class="kw">hist</span>(x,<span class="dt">breaks=</span><span class="kw">c</span>(.<span class="dv">5</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">3.5</span>),<span class="dt">right=</span><span class="ot">TRUE</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="dt">labels=</span>T,<span class="dt">ylab=</span><span class="st">&quot;gyakoriság&quot;</span>)</a>
<a class="sourceLine" id="cb710-6" title="6"><span class="kw">hist</span>(x,<span class="dt">freq=</span>F,<span class="dt">breaks=</span><span class="kw">c</span>(.<span class="dv">5</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">3.5</span>),<span class="dt">right=</span><span class="ot">TRUE</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">6</span>), <span class="dt">labels=</span>T,<span class="dt">ylab=</span><span class="st">&quot;relatív gyakoriság&quot;</span>,<span class="dt">col=</span><span class="kw">rainbow</span>(<span class="dv">12</span>))</a>
<a class="sourceLine" id="cb710-7" title="7"><span class="kw">hist</span>(rx,<span class="dt">freq=</span>F,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">3</span>),<span class="dt">ylab=</span><span class="st">&quot;relatív gyakoriság&quot;</span>, <span class="dt">col=</span><span class="kw">rainbow</span>(<span class="dv">10</span>),<span class="dt">main=</span><span class="st">&quot;Hisztogram&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">2</span>))</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/hisztogram-abra-1.svg" width="672" /></p>
<p>A <code>boxplot()</code> függvény</p>
<p>A <code>boxplot()</code> függvény a hisztogramhoz hasonlóan az adatmegtekintés vizualizálását segíti ún. dobozdiagramok megjelenítésével. A dobozdiagramról a minta terjedelme (legkisebb és legnagyobb értéke), az alsó- és felsőkvartilis, illetve a medián olvasható le. Általában több csoport adatait hasonlítjuk össze a dobozdiagram segítségével.
A <code>boxplot()</code> függvény range paraméterével a kiugró értékek kezelését befolyásolhatjuk.</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb711-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb711-2" title="2">rx&lt;-<span class="kw">rchisq</span>(<span class="dv">100</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb711-3" title="3"><span class="kw">boxplot</span>(rx)</a>
<a class="sourceLine" id="cb711-4" title="4"><span class="kw">boxplot</span>(rx,<span class="dt">range=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb711-5" title="5"><span class="kw">boxplot</span>(count<span class="op">~</span>spray, <span class="dt">data=</span>InsectSprays, <span class="dt">col=</span><span class="st">&quot;lightgray&quot;</span>)</a>
<a class="sourceLine" id="cb711-6" title="6"><span class="kw">boxplot</span>(decrease<span class="op">~</span>treatment, <span class="dt">data=</span>OrchardSprays, <span class="dt">col=</span><span class="st">&quot;bisque&quot;</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-234-1.svg" width="672" /></p>
</div>
<div id="a-pie-fuggveny" class="section level4">
<h4><span class="header-section-number">7.1.4.5</span> A <code>pie()</code> függvény</h4>
<p>A kördiagramot a <code>pie()</code> függvénnyel készíthetünk. A radius argumentum a kör sugarát adja meg, a clockwise a körcikkek körbejárási irányát adja meg.</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb712-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb712-2" title="2"><span class="kw">pie</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="dt">col =</span> <span class="kw">rainbow</span>(<span class="dv">20</span>))</a>
<a class="sourceLine" id="cb712-3" title="3"><span class="kw">pie</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>), <span class="dt">radius=</span><span class="fl">0.9</span>, <span class="dt">clockwise =</span> T)</a>
<a class="sourceLine" id="cb712-4" title="4">pie.sales &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.12</span>, <span class="fl">0.3</span>, <span class="fl">0.26</span>, <span class="fl">0.16</span>, <span class="fl">0.04</span>, <span class="fl">0.12</span>)</a>
<a class="sourceLine" id="cb712-5" title="5"><span class="kw">names</span>(pie.sales) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Honda&quot;</span>, <span class="st">&quot;Toyota&quot;</span>, <span class="st">&quot;Mazda&quot;</span>, <span class="st">&quot;Volkswagen&quot;</span>, <span class="st">&quot;Egyéb&quot;</span>, <span class="st">&quot;Skoda&quot;</span>)</a>
<a class="sourceLine" id="cb712-6" title="6"><span class="kw">pie</span>(pie.sales)</a>
<a class="sourceLine" id="cb712-7" title="7"><span class="kw">pie</span>(pie.sales, <span class="dt">col =</span> <span class="kw">gray</span>(<span class="kw">seq</span>(<span class="fl">0.4</span>,<span class="fl">1.0</span>,<span class="dt">length=</span><span class="dv">6</span>)))</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-235-1.svg" width="672" /></p>
</div>
<div id="a-barplot-fuggveny" class="section level4">
<h4><span class="header-section-number">7.1.4.6</span> A <code>barplot()</code> függvény</h4>
<p>A <code>barplot()</code> függvény oszlopdiagram létrehozását teszi lehetővé. Numerikus vektorból vagy mátrixból hozhatunk létre oszlopdiagramot. Használhatjuk a horiz argumentumot, amellyel fekvő vagy álló oszlopdiagramot hozhatunk létre vagy a space-t, amellyel az oszlopok egymás közötti távolságát adhatjuk meg. Mátrix bemenő paraméter esetén az egy oszlopban lévő elemeket egy csoportpa sorolja a box() függvény. A beside argumentum FALSE értéke mellett a csoportok egymás mellett, a csoportok elemei pedig egymás felett jelennek meg. A beside TRUE értéke mellett a csoportok elemei egymás mellett szerepelnek, de a csoportok között nagyobb lesz a távolság. A fentieket szemlélteti a 6.15. ábra.</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb713-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb713-2" title="2"><span class="kw">barplot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">5</span><span class="op">:</span><span class="dv">1</span>),<span class="dt">main=</span><span class="st">&quot;Vektor argumentum</span><span class="ch">\n</span><span class="st">horiz=F&quot;</span>,<span class="dt">col=</span><span class="kw">heat.colors</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb713-3" title="3"><span class="kw">barplot</span>(<span class="kw">rpois</span>(<span class="dv">12</span>, <span class="dt">lambda=</span><span class="dv">5</span>),<span class="dt">main=</span><span class="st">&quot;Vektor argumentum</span><span class="ch">\n</span><span class="st">horiz=T&quot;</span>,<span class="dt">col=</span><span class="kw">heat.colors</span>(<span class="dv">12</span>),<span class="dt">horiz=</span>T)</a>
<a class="sourceLine" id="cb713-4" title="4">m&lt;-<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,<span class="dt">ncol=</span><span class="dv">3</span>); m</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    5    9
## [2,]    2    6   10
## [3,]    3    7   11
## [4,]    4    8   12</code></pre>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb715-1" title="1"><span class="kw">barplot</span>(m,<span class="dt">main=</span><span class="st">&quot;Mátrix argumentum</span><span class="ch">\n</span><span class="st">beside=F&quot;</span>,<span class="dt">col=</span><span class="kw">rainbow</span>(<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb715-2" title="2"><span class="kw">barplot</span>(m,<span class="dt">main=</span><span class="st">&quot;Mátrix argumentum</span><span class="ch">\n</span><span class="st">beside=T, space=c(1,4)&quot;</span>,<span class="dt">beside=</span>T, <span class="dt">space=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">col=</span><span class="kw">rainbow</span>(<span class="dv">4</span>))</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-236-1.svg" width="672" /></p>
</div>
</div>
<div id="alacsony-szintu-rajzfuggvenyek" class="section level3">
<h3><span class="header-section-number">7.1.5</span> Alacsony-szintű rajzfüggvények</h3>
<p>Az alacsony-szintű függvények segítségével meglévő ábráinkhoz adhatunk hozzá elemeket. Szöveget írhatunk a külső vagy belső margóra az <code>mtext()</code>, az ábraterületre pedig a <code>text()</code> függvénnyel. Az ábraterültre pontokat helyezhetünk el points(), vonalakat a <code>lines()</code> és az <code>abline()</code> függvénnyel. Továbbá rajzolhatunk téglalapot a <code>rect()</code>, sokszöget a polygon() függvénnyel. Az ábránkra tengelyeket rajzolhatunk az <code>axis()</code>, szegélyeket a <code>box()</code>, jelmagyarázatot a <code>legend()</code>, címet és alcímet a <code>title()</code> függvénnyel.</p>
<div id="szoveg-elhelyezese" class="section level5">
<h5><span class="header-section-number">7.1.5.0.1</span> Szöveg elhelyezése</h5>
<p>Az mtext() függvényben a szöveg helyét a line argumentum határozza meg: az alapértelmezett 0 segítségével a margóra tudunk írni , de kintebb vagy beljebb is tudunk írni a margóhoz képest pozitív vagy negatív érték megadása esetén. A text() függvényben a szöveg helyét a felhasználó koordinátarendszerében értendő x és y argumentum értékei határozzák meg.
Mindkét függvény esetében az adj argumentum határozza meg a szöveg igazítását, ami tipikusan 0 és 1 közötti numerikus érték, de a legtöbb grafikus eszközön kibővíthetjük ezt a tartományt. A text() függvény esetében ez a paraméter kételemű vektor is lehet, az első érték az x a második az y irányában határozza meg az igazítást. Az mtext() függvény esetében egyetlen érték is elegendő igazításra, a másik pozíciót a line argumentum értékéből következik. Mindezt a 6.16. ábráról is leolvashatjuk.</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb716-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dt">xlab=</span><span class="kw">expression</span>(x[y]),<span class="dt">ylab=</span><span class="kw">expression</span>(x<span class="op">^</span>y), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb716-2" title="2"><span class="kw">mtext</span>(<span class="st">&quot;mtext(line= -1,side=3)&quot;</span>,<span class="dt">line=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">side=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb716-3" title="3"><span class="kw">mtext</span>(<span class="st">&quot;mtext(line=1,side=3,adj=0.2)&quot;</span>,<span class="dt">line=</span><span class="dv">1</span>,<span class="dt">side=</span><span class="dv">3</span>,<span class="dt">adj=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb716-4" title="4"><span class="kw">mtext</span>(<span class="st">&quot;mtext(line=0,side=4,adj=1)&quot;</span>,<span class="dt">line=</span><span class="dv">0</span>,<span class="dt">side=</span><span class="dv">4</span>,<span class="dt">adj=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb716-5" title="5"><span class="kw">points</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">7</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">7</span>,<span class="dt">pch=</span><span class="dv">3</span>, <span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb716-6" title="6"><span class="kw">text</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="st">&quot;text(2,2)&quot;</span>)</a>
<a class="sourceLine" id="cb716-7" title="7"><span class="kw">text</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="st">&quot;text(6,6,adj=c(0,0))&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb716-8" title="8"><span class="kw">text</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="st">&quot;text(4,4,adj=c(1,0))&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb716-9" title="9"><span class="kw">text</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="st">&quot;text(5,5,adj=c(0,1))&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb716-10" title="10"><span class="kw">text</span>(<span class="dv">6</span>,<span class="dv">6</span>,<span class="st">&quot;text(6,6,adj=c(1,1))&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb716-11" title="11"><span class="kw">text</span>(<span class="dv">7</span>,<span class="dv">7</span>,<span class="st">&quot;text(7,7,adj=c(0.5,0.5))&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>))</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-237-1.svg" width="672" /></p>
<p>Az x és y tengely feliratában alsó és felső indexet is használhatunk. Ehhez az expression() függvényt használjuk fel, amellyel kifejezéseket hozhatunk létre az R-ben. Alsó indexek írására a szögletes zárójelet (pl. x[y]), felső indexre a hatványozás jelét (pl. x^y) használhatjuk.
A megjelenítendő szöveg betűtípusát is megváltoztathatjuk a font és a family argumentumok segítségével. A font értékei: 1=normál, 2=félkövér,3=dőlt és 4=félkövér/dőlt. A family argumentum egy betűcsalád nevét tartalmazhatja, alapértelmezett értékei a ”serif”, ”sans”, ”mono” és ”symbol” lehetnek. A számítógépen egyéb betűcsaládok a windowsFonts() és a windowFont() függvények használata után lesznek elérhetőek az R-ben.</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb717-1" title="1"><span class="kw">windowsFonts</span>( <span class="dt">font.comic =</span> <span class="kw">windowsFont</span>(<span class="st">&quot;Comic Sans MS&quot;</span>), <span class="dt">font.verdana =</span> <span class="kw">windowsFont</span>(<span class="st">&quot;Verdana&quot;</span>),<span class="dt">font.trebuchet =</span> <span class="kw">windowsFont</span>(<span class="st">&quot;Trebuchet MS&quot;</span>),<span class="dt">font.book.antiqua =</span> <span class="kw">windowsFont</span>(<span class="st">&quot;Book Antiqua&quot;</span>))</a>
<a class="sourceLine" id="cb717-2" title="2"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb717-3" title="3"><span class="kw">par</span>(<span class="dt">cex=</span><span class="fl">1.4</span>)</a>
<a class="sourceLine" id="cb717-4" title="4"><span class="kw">text</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="st">&quot;serif&quot;</span>,<span class="dt">family=</span><span class="st">&quot;serif&quot;</span>,<span class="dt">font=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb717-5" title="5"><span class="kw">text</span>(<span class="dv">2</span>,<span class="dv">6</span>,<span class="st">&quot;sans&quot;</span>,<span class="dt">family=</span><span class="st">&quot;sans&quot;</span>,<span class="dt">font=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb717-6" title="6"><span class="kw">text</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="st">&quot;mono&quot;</span>,<span class="dt">family=</span><span class="st">&quot;mono&quot;</span>,<span class="dt">font=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb717-7" title="7"><span class="kw">text</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="st">&quot;symbol&quot;</span>,<span class="dt">family=</span><span class="st">&quot;symbol&quot;</span>,<span class="dt">font=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb717-8" title="8"><span class="kw">text</span>(<span class="dv">8</span>,<span class="dv">8</span>,<span class="st">&quot;Comic Sans MS&quot;</span>,<span class="dt">family=</span><span class="st">&quot;font.comic&quot;</span>,<span class="dt">font=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb717-9" title="9"><span class="kw">text</span>(<span class="dv">8</span>,<span class="dv">6</span>,<span class="st">&quot;Verdana&quot;</span>,<span class="dt">family=</span><span class="st">&quot;font.verdana&quot;</span>,<span class="dt">font=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb717-10" title="10"><span class="kw">text</span>(<span class="dv">8</span>,<span class="dv">4</span>,<span class="st">&quot;Trebuchet MS&quot;</span>,<span class="dt">family=</span><span class="st">&quot;font.trebuchet&quot;</span>,<span class="dt">font=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb717-11" title="11"><span class="kw">text</span>(<span class="dv">8</span>,<span class="dv">2</span>,<span class="st">&quot;Book Antiqua&quot;</span>,<span class="dt">family=</span><span class="st">&quot;font.book.antiqua&quot;</span>,<span class="dt">font=</span><span class="dv">4</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-238-1.svg" width="672" /></p>
</div>
<div id="pontok-vonalak" class="section level4">
<h4><span class="header-section-number">7.1.5.1</span> Pontok, vonalak</h4>
<p>A points() függvény x és y paramétere a megjelenítendő pontok koordinátáit tartalmazzák, míg a lines() függvény ugyanezen paraméterek mellett egyenes szakaszokkal köti össze pontokat. A megjelenítendő pontok alakját a pch, a vonalak típusát pedig a lty paraméter határozza meg.</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb718-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb718-2" title="2">x&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb718-3" title="3"><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,x<span class="op">+</span><span class="dv">7</span>, <span class="dt">pch=</span><span class="st">&quot;*&quot;</span>,<span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb718-4" title="4"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,x<span class="fl">+4.4</span>,<span class="dt">lty=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb718-5" title="5"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,x<span class="op">+</span><span class="dv">4</span>,  <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb718-6" title="6"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,x<span class="fl">+3.6</span>,<span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb718-7" title="7"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,x<span class="fl">+3.2</span>,<span class="dt">lty=</span><span class="dv">4</span>, <span class="dt">lwd=</span><span class="fl">2.5</span>)</a>
<a class="sourceLine" id="cb718-8" title="8"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,x<span class="fl">+2.8</span>,<span class="dt">lty=</span><span class="dv">5</span>, <span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb718-9" title="9"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,x<span class="fl">+2.2</span>,<span class="dt">lty=</span><span class="dv">6</span>, <span class="dt">lwd=</span><span class="fl">3.5</span>)</a>
<a class="sourceLine" id="cb718-10" title="10"><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,x,   <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb718-11" title="11"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,x,    <span class="dt">lty=</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-239-1.svg" width="672" /></p>
<p>Egyeneseket az abline() segítségével is létrehozhatunk. Legfontosabb argumentumok az a és a b, amelyek az y tengellyel való metszéspontot és az egyenes meredekséget adják meg. Függőleges és vízszintes egyeneseket is rajzolhatunk a v és h paraméterek megadásával.</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb719-1" title="1"><span class="kw">plot</span>(<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">5</span>,<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb719-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">v=</span><span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;gray60&quot;</span>)</a>
<a class="sourceLine" id="cb719-3" title="3"><span class="kw">text</span>(<span class="fl">0.1</span>,<span class="dv">0</span>, <span class="st">&quot;abline ( h = 0 )&quot;</span>,<span class="dt">col=</span><span class="st">&quot;gray60&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb719-4" title="4"><span class="kw">text</span>(<span class="dv">0</span>,<span class="fl">0.1</span>, <span class="st">&quot;abline ( v = 0 )&quot;</span>,<span class="dt">col=</span><span class="st">&quot;gray60&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="fl">0.1</span>),<span class="dt">srt=</span><span class="dv">90</span>)</a>
<a class="sourceLine" id="cb719-5" title="5"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">v =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb719-6" title="6"><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">1</span>, <span class="dt">b=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb719-7" title="7"><span class="kw">text</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="st">&quot;abline( 1, 2 )&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="op">-</span>.<span class="dv">1</span>,<span class="op">-</span>.<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb719-8" title="8"><span class="kw">abline</span>(<span class="dt">a=</span><span class="op">-</span><span class="dv">2</span>, <span class="dt">b=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb719-9" title="9"><span class="kw">text</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">3</span>,<span class="st">&quot;abline( -2, -1 )&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="op">-</span>.<span class="dv">1</span>,<span class="op">-</span>.<span class="dv">1</span>))</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-240-1.svg" width="672" /></p>
</div>
<div id="teglalapok-poligonok-nyilak" class="section level4">
<h4><span class="header-section-number">7.1.5.2</span> Téglalapok, poligonok, nyilak</h4>
<p>A rect() függvénnyel téglalapot rajzolhatunk az ábraterületre. A téglalapok bal alsó és jobb felső sarkának x és y koordinátáját kell megadnunk, ezek rendre: xleft, ybottom, xright, ytop.</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb720-1" title="1"><span class="kw">plot</span>(<span class="dv">100</span><span class="op">:</span><span class="dv">500</span>,<span class="dv">100</span><span class="op">:</span><span class="dv">500</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb720-2" title="2">x&lt;-<span class="kw">runif</span>(<span class="dv">50</span>)<span class="op">*</span><span class="dv">350</span></a>
<a class="sourceLine" id="cb720-3" title="3">y&lt;-<span class="kw">runif</span>(<span class="dv">50</span>)<span class="op">*</span><span class="dv">330</span></a>
<a class="sourceLine" id="cb720-4" title="4"><span class="kw">rect</span>(<span class="dv">100</span><span class="op">+</span>x, <span class="dv">100</span><span class="op">+</span>y, <span class="dv">150</span><span class="op">+</span>x, <span class="dv">170</span><span class="op">+</span>y, <span class="dt">col=</span><span class="kw">rainbow</span>(<span class="dv">11</span>,<span class="dt">start=</span>.<span class="dv">7</span>,<span class="dt">end=</span>.<span class="dv">1</span>),<span class="dt">border=</span><span class="kw">gray</span>(x<span class="op">/</span><span class="dv">400</span>),<span class="dt">lwd=</span>x<span class="op">%%</span><span class="dv">10</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-241-1.svg" width="672" /></p>
<p>A polygon() függvény tetszőleges egyenesekkel határolt síkidomok létrehozásáért felelős. Az x és y paraméterében várja a csúcspontok koordinátáit. A lenti példában a vonalak rajzolására használatos segments() függvény is bemutatásra kerül, azt láthatjuk, hogy a polygon() függvény argumentuma, hogyan feleltethető meg a segments() függvény bemenő paraméterének.</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb721-1" title="1">my_segments&lt;-<span class="cf">function</span>(x,y) {</a>
<a class="sourceLine" id="cb721-2" title="2">i&lt;-<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb721-3" title="3"><span class="kw">segments</span>(x[i],y[i],x[i<span class="op">+</span><span class="dv">1</span>],y[i<span class="op">+</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb721-4" title="4"><span class="kw">segments</span>(x[<span class="kw">length</span>(x)],y[<span class="kw">length</span>(x)],x[<span class="dv">1</span>],y[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb721-5" title="5">}</a>
<a class="sourceLine" id="cb721-6" title="6"></a>
<a class="sourceLine" id="cb721-7" title="7"><span class="kw">plot</span>(<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">5</span>,<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb721-8" title="8"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">v=</span><span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;gray60&quot;</span>)</a>
<a class="sourceLine" id="cb721-9" title="9"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">-4</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">v =</span> <span class="dv">-4</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb721-10" title="10">x&lt;-<span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb721-11" title="11">y&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb721-12" title="12"><span class="kw">polygon</span>(x,y,<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb721-13" title="13">y&lt;-y<span class="op">+</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb721-14" title="14"><span class="kw">my_segments</span>(x,y)</a>
<a class="sourceLine" id="cb721-15" title="15"></a>
<a class="sourceLine" id="cb721-16" title="16">x&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb721-17" title="17">y&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb721-18" title="18"><span class="kw">polygon</span>(x,y,<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb721-19" title="19">y&lt;-y<span class="op">+</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb721-20" title="20"><span class="kw">my_segments</span>(x,y)</a>
<a class="sourceLine" id="cb721-21" title="21"></a>
<a class="sourceLine" id="cb721-22" title="22">my_func&lt;-<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb721-23" title="23"><span class="kw">return</span> (<span class="dv">5</span><span class="op">*</span><span class="kw">dnorm</span>(x,<span class="dt">mean=</span><span class="op">-</span><span class="dv">2</span>,<span class="dt">sd=</span>.<span class="dv">6</span>)<span class="op">-</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb721-24" title="24">}</a>
<a class="sourceLine" id="cb721-25" title="25"><span class="kw">curve</span>(my_func,<span class="dt">from=</span><span class="op">-</span><span class="dv">4</span>,<span class="dt">to=</span><span class="dv">0</span>, <span class="dt">add=</span>T)</a>
<a class="sourceLine" id="cb721-26" title="26">xp&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="op">-</span><span class="fl">2.5</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb721-27" title="27"><span class="kw">polygon</span>(<span class="kw">c</span>(xp,<span class="op">-</span><span class="fl">2.5</span>),<span class="kw">c</span>(<span class="kw">my_func</span>(xp),<span class="op">-</span><span class="dv">4</span>),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb721-28" title="28"><span class="kw">curve</span>(<span class="kw">my_func</span>(x<span class="dv">-5</span>),<span class="dt">from=</span><span class="dv">1</span>,<span class="dt">to=</span><span class="dv">5</span>, <span class="dt">add=</span>T)</a>
<a class="sourceLine" id="cb721-29" title="29">xp&lt;-<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">4</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb721-30" title="30"><span class="kw">polygon</span>(<span class="kw">c</span>(<span class="dv">2</span>,xp,<span class="dv">4</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="kw">my_func</span>(xp<span class="dv">-5</span>),<span class="op">-</span><span class="dv">4</span>),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="r_bioinf_files/figure-html/unnamed-chunk-242-1.svg" width="672" /></p>
</div>
<div id="egyeb-kiegeszitok" class="section level4">
<h4><span class="header-section-number">7.1.5.3</span> Egyéb kiegészítők</h4>
<p>Ha ábránk létrehozása során korábban nem gondoskodtunk cím/alcím, tengelyek, szegély vagy jelmagyarázat megrajzolásáról, akkor alacsony-szintű rajzfüggvényekkel utólag is hozzáadhatjuk ezeket a grafikánkhoz.</p>
<p>A <code>tilte()</code> függvény fontosabb argumentumai a következők:</p>
<ul>
<li><p><code>main</code>, <code>sub</code><br />
Az ábra címének és alcímének meghatározására használjuk.</p></li>
<li><p><code>xlab</code>, <code>ylab</code><br />
Tengelyfeliratok hozzáadása.</p></li>
<li><p><code>line</code><br />
Az alapértelmezett szövegpozíciót írhatjuk felül, ha meghatározzuk a szövegsor sorszámát.</p></li>
<li><p><code>outer</code><br />
Az ábra címét a külső margóra írhatjuk ha TRUE értéket adunk meg.</p></li>
</ul>
<p>A <code>box()</code> függvény legfontosabb argumentuma:</p>
<ul>
<li><code>which</code><br />
A bekeretezendő terület meghatározása. Értékei lehetnek:
<ul>
<li><code>"plot"</code> rajzterület szegélyezése</li>
<li><code>"figure"</code> ábraterület szegélyezése</li>
<li><code>"inner"</code> több ábra esetén az ábraterületeket fogja össze</li>
<li><code>"outer"</code> az eszközfelület szegélyezése</li>
</ul></li>
</ul>
<p>A tengelyek megjelenítését szabályzó grafikai paraméterek, az axis() függvény használata során:</p>
<p>xaxt, yaxt Az x és y tengely kirajzolását tilthatjuk meg, ha ”n” értékkel látjuk el. Alapértelmezett az ”s”, ekkor megrajzolja az illető tengelyt. (Hasonló a szerepe, mint az axes argumentumnak.)
mgp=c(3,1,0) A tengely egyes részeinek a rajzterület szélétől mért távolságát meghatározó 3 elemű vektor. Az első érték a tengelyfelirat, a második a tengelycímkék, a harmadik magának a tengely vonalának a margóját adja meg.
lab Háromelemű numerikus vektor, amelynek az első két elemével az x és az y tengely beosztásainak a számát határozhatjuk meg. A tényleges osztásszám az általunk megadott értéktől eltérhet. A harmadik elemet nem veszi figyelembe az R.
xaxp, yaxp Leginkább lekérdezésre szánt 3 elemű numerikus vektor. Az első és második elem a két szélső beosztás értéket adja, a harmadik elem pedig az osztályok számát.
xaxs, yaxs Az alapértelmezett ”r” érték mellett a tengelyek által átfogott intervallum az ábrázolandó adatokból kiszámolt vagy az xlim, ylim paraméterekből kapott intervallumnál 4%-al nagyobb lesz. Pontos egyezéshez az ”i” értéket kell megadnunk.
tck, tcl, las, xlim, ylim, log, xlog, ylog Korábban már szerepletek.</p>
<p>Az axis() függvény fontos argumentumai:
side A rajzolandó tengely helye: 1=lennt, 2=balra, 3=fennt, 4=jobbra..
at=NULL A beosztások helyét határozza meg. Ha az értéke NULL, akkor automatikusan számolja az R, egyébként a megadott numerikus vektor elemeinek megfelelő helyre kerül beosztás.
labels A beosztások címkéit határozza meg.</p>
<p>Jelmagyarázat többnyire a rajzterületen belül foglal helyet, a pozícióját is a felhasználói koordinátákban kell megadni. A jelmagyarázat létrehozását számos paraméter segíti, de az ábrán szereplő és a jelmagyarázatban használt jelek közötti összhangot nekünk kell megteremteni, az R semmilyen ellenőrzést nem végez ezzel kapcsolatban.
A legend() függvény argumentumai:
x, y A jelmagyarázat bal felső sarkának a koordinátái a rajzterület koordintáiban mérve.
Az x argumentum karakteres értékével az igazítást adhatjuk meg: “bottomright”, “bottom”, “bottomleft”, “left”, “topleft”, “top”, “topright”, “right” and “center”
legend A jelmagyarázat szövegét tartalmazó karakteres vektor.
fill, lty, lwd, pch A jelmagyarázat szövegét és az ábrán használt jeleket összekötő szimbólumok létrehozására használható argumentumok.
inset=0 Ha kulcsszavakat használunk az igazításra, akkor a margótól mért távolságot itt adhatjuk meg.
merge Ha pontokat és vonalakat is használunk a jelmagyarázatban, akkor TRUE érték mellett ezeket kombinálja a megjelenítéskor.
horiz=FALSE A jelmagyarázat tájolását befolyásoló logikai paraméter.
ncol=1 A jelmagyarázat oszlopainak a számát határozza meg.
text.col, bg A szöveg színe és a háttérszín jelmagyarázatban.</p>
<blockquote>
<p>op&lt;-par()
par(oma=c(.5,.5,2,.5))
par(mfrow=c(2,2))
x&lt;-rnorm(10)</p>
</blockquote>
<blockquote>
<p>plot(x,main="“,axes=F,xlab=”“,ylab=”“,col=gray(0.7))
text(5.5,0,”Alapértelmezett“,font=2)
title(main=”Cím a külső margón“,outer=T,line=0.2)
title(main=”Cím a belső margón“)
title(sub=”ALCÍM“)
title(xlab=”x“,ylab=”y“)
box(”outer“,lty=1,col=grey(.2))
box(”inner“,lty=2,col=grey(.4))
box(”figure“,lty=3,col=grey(.6))
box(”plot",lty=4,col=grey(.8))
axis(1, at=1:10);axis(2)</p>
</blockquote>
<blockquote>
<p>par(xaxs=“i”)
par(yaxs=“i”)
par(mgp=c(2,.5,0))
plot(x,main=‘xaxs=“i”,yaxs=“i”,mgp=c(2,.5,0)’,axes=F,
+ xlab=“axis(1,at=1:10,tcl=.3)”,ylab="“)
box(”plot",lty=4,col=grey(.8))
axis(1,at=1:10,tcl=.3)</p>
<p>par(xaxs=“r”)
par(yaxs=“r”)</p>
<p>par(mgp=c(3,1,-.2))
plot(x,main=‘xaxs=“r”,yaxs=“r”,mgp=c(3,1,-.2)’,axes=F,xlab=“axis(1,at=3:8,labels=LETTERS[1:6])”,ylab="“)
box(”plot",lty=4,col=grey(.8))
axis(1,at=3:8,labels=LETTERS[1:6])
axis(2)
axis(4)</p>
<p>par(mgp=c(3,1,0))</p>
<p>par(mar=c(1,1,1,1))
plot(1:10,main="“,axes=F,xlab=”“,ylab=”“,type=”n“)
box(”figure“,lty=3,col=grey(.6))
box(”plot“,lty=4,col=grey(.8))
legend(”topleft“,LETTERS[1:3],lw=1:3,inset=.1)
legend(”top“,LETTERS[1:3],lty=1:3,inset=.1)
legend(”topright“,LETTERS[1:3],lty=1:3,pch=0:3,inset=.05)
legend(”right“,LETTERS[1:3],lw=1:3,pch=0:3)
legend(”bottomright",LETTERS[1:3],fill=2:4,text.col=2:4)
legend(1,7, as.character(0:25), pch = 0:25,ncol=4,cex=1.2)</p>
<p>par(op)</p>
</blockquote>
<p>6.22. ábra</p>
</div>
</div>
<div id="interaktiv-grafikus-fuggvenyek" class="section level3">
<h3><span class="header-section-number">7.1.6</span> Interaktív grafikus függvények</h3>
<p>Az R hagyományos grafikus rendszere elsősorban statikus ábrák létrehozását támogatja, a kész grafikán további interaktív műveletekre csak korlátozottan van lehetőség. Ezek közül most a <code>locator()</code> és az <code>identify()</code> függvényeket tekintjük át.
A <code>locator()</code> függvény lehetővé teszi, hogy a felhasználó a rajzterületen az egér bal gombjával kijelöljön egy vagy több pontot. A függvény visszatérési értéke egy lista, amely a megjelölt pontok x és y koordinátáit sorolja fel.</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb722-1" title="1"><span class="kw">legend</span>(<span class="kw">locator</span>(<span class="dv">1</span>), <span class="kw">as.character</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">25</span>), <span class="dt">pch =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">25</span>)</a></code></pre></div>
<p>A <code>locator()</code> függvény fontosabb argumentumai:</p>
<ul>
<li><code>n=</code> A meghatározandó pontok maximális számát adhatjuk meg. Alapértelmezetten 512 pont helyét kaphatjuk meg.</li>
<li><code>type=</code> Értéke az ”n”, ”p”, ”l” vagy ”o” karakter valamelyike lehet. Az alapértelmezett ”n” esetében az egérkattintás után nem történik megjelenítés, míg ”p” és ”o” hatására egy pont fog megjelenni, ”l” vagy ”o” estén pedig vonal fogja összekötni a megjelölt helyeket.</li>
</ul>
<p>Az <code>identify()</code> függvény a rajzterületen megjelenő adatpontokhoz rendel címkét. A <code>locator()</code> függvényhez hasonlóan az egér bal gombjával itt is ki kell jelölni egy pontot a rajzterületen, majd a függvény a megjelölt ponthoz legközelebb lévő adatponthoz rendel egy címkét. Az <code>indentify()</code> függvény visszatérési értéke az azonosított adatpontok indexe.</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb723-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb723-2" title="2"><span class="kw">plot</span>(mammals<span class="op">$</span>body, mammals<span class="op">$</span>brain, <span class="dt">log=</span><span class="st">&quot;xy&quot;</span>)</a>
<a class="sourceLine" id="cb723-3" title="3"><span class="kw">identify</span>(mammals<span class="op">$</span>body, mammals<span class="op">$</span>brain, <span class="kw">row.names</span>(mammals), <span class="dt">n=</span><span class="dv">10</span>)</a></code></pre></div>
<p>Az <code>identify()</code> függvény fontosabb argumentumai:</p>
<ul>
<li><p><code>x=</code>, <code>y=</code><br />
Numerikus vektorok, amelyek az ábra adatpontjainak x és y koordinátáit határozzák meg.</p></li>
<li><p><code>labels=</code><br />
Karakteres vektor, amely egyes adatpontok címkéit tartalmazza. Az x és y argumentumokkal azonos hosszú vektor, alapértelmezetten sorszámokat tartalmaz.</p></li>
<li><p><code>pos=FALSE</code><br />
Ha FALSE az értéke, akkor a függvény az azonosított adatpontok indexével fog visszatérni. Ha TRUE, akkor egy listával, amely az ind elemében az indexeket, pos elemében pedig a címke adatponthoz viszonyított helyét tartalmazza (1=lennt, 2=balra, 3=fennt, 4=jobbra, ill. 0=ekkor az atpen=TRUE volt)</p></li>
<li><code>n=</code><br />
A megjelelölendő pontok száma.</li>
<li><p><code>plot=TRUE</code><br />
Logikai érték, amely ha TRUE (ez az alapértelmezett), akkor megjelenít címkéket, egyébként nem.</p></li>
<li><p><code>atpen=FALSE</code><br />
A címke pozíciója TRUE érték esetén az egérkattintás helye lesz, FALSE esetén automatikusan kerül meghatározásra.</p></li>
<li><p><code>offset=0.5</code><br />
A címke és az adatpont távolsága. A numerikus érték a karakterszélességhez mért. Az atpen=FALSE esetén nem használja az R.</p></li>
<li><p><code>tolarence=0.25</code><br />
Inch-ben mért numerikus érték, amely az egérkattintás és a „közeli” adatpont közötti maximális távolságot jelenti.</p></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="grafika-az-r-ben.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-modern-grafika-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/10-Grafika.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["r_bioinf.pdf", "r_bioinf.epub", "r_bioinf.mobi"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
